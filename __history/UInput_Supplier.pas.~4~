unit UInput_Supplier;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, RzButton, Vcl.ExtCtrls, RzPanel,
  Vcl.StdCtrls;

type
  TFInput_Supplier = class(TForm)
    Edno: TEdit;
    EdNm: TEdit;
    EdAlamat: TEdit;
    EdTelp: TEdit;
    EdNPWP: TEdit;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Panel2: TPanel;
    BBatal: TRzBitBtn;
    BSimpan: TRzBitBtn;
    BEdit: TRzBitBtn;
    procedure BBatalClick(Sender: TObject);
    procedure BEditClick(Sender: TObject);
    procedure BSimpanClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FInput_Supplier: TFInput_Supplier;

implementation

{$R *.dfm}

uses UDataModule, UListSupplier;

procedure TFInput_Supplier.BBatalClick(Sender: TObject);
begin
  Close;
end;

procedure TFInput_Supplier.BEditClick(Sender: TObject);
begin
    BEdit.Visible:=false;
    BSimpan.Visible:=true;
    if Edno.Text='' then
    begin
      MessageDlg('Kode Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdNo.SetFocus;
      Exit;
    end;
    if EdNm.Text='' then
    begin
      MessageDlg('Nama Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdNm.SetFocus;
      Exit;
    end;
    if EdAlamat.Text='' then
    begin
      MessageDlg('Alamat Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdAlamat.SetFocus;
      Exit;
    end;
    if Edtelp.Text='' then
    begin
      MessageDlg('Telepon Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      Edtelp.SetFocus;
      Exit;
    end;
    if not dm.koneksi.InTransaction then
    dm.koneksi.StartTransaction;
    try
    begin
     with dm.Qtemp do
    begin
      close;
      sql.clear;
      sql.Text:='Select * from t_supplier';
      ExecSQL;
    end;
     with dm.Qtemp do
    begin
      close;
      sql.clear;
      sql.Text:='Update t_supplier set nm_supplier='+QuotedStr(Ednm.Text)+ ' , Alamat='+QuotedStr(EdAlamat.Text)+' ,telp='+QuotedStr(Edtelp.Text)+''+
                ' ,npwp='+QuotedStr(EdNPWP.Text)+''+
                ' Where kd_supplier='+QuotedStr(Edno.Text);
      ExecSQL;
      end;
    dm.koneksi.Commit;
    Messagedlg('Data Berhasil di Simpan',MtInformation,[Mbok],0);
    end
    Except
    on E :Exception do
    begin
    MessageDlg(E.Message,mtError,[MBok],0);
    dm.koneksi.Rollback;
    end;
    end;
      BBatalClick(sender);;
    end;

procedure TFInput_Supplier.BSimpanClick(Sender: TObject);
begin
    if Edno.Text='' then
    begin
      MessageDlg('Kode Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdNo.SetFocus;
      Exit;
    end;
    if EdNm.Text='' then
    begin
      MessageDlg('Nama Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdNm.SetFocus;
      Exit;
    end;
    if EdAlamat.Text='' then
    begin
      MessageDlg('Alamat Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      EdAlamat.SetFocus;
      Exit;
    end;
    if Edtelp.Text='' then
    begin
      MessageDlg('Telepon Supplier Tidak boleh Kosong ',MtWarning,[MbOk],0);
      Edtelp.SetFocus;
      Exit;
    end;
    if not dm.koneksi.InTransaction then
    dm.koneksi.StartTransaction;
    try
    begin
      with dm.Qtemp do
      begin
        close;
        sql.clear;
        sql.Text:='Select * from t_supplier';
        ExecSQL;
      end;

      with dm.Qtemp do
      begin
        close;
        sql.clear;
        sql.Text:='Insert into t_supplier(kd_supplier,nm_supplier,alamat,Telp, npwp)values'+
                  '('+QuotedStr(Edno.Text)+','+QuotedStr(EdNm.Text)+','+QuotedStr(EdAlamat.Text)+','+
                  ''+QuotedStr(EdTelp.Text)+','+QuotedStr(EdNPWP.Text)+')';
        ExecSQL;
      end;
      dm.koneksi.Commit;
      Messagedlg('Data Berhasil di Simpan',MtInformation,[Mbok],0);
      end
    Except
    on E :Exception do
    begin
      MessageDlg(E.Message,mtError,[MBok],0);
      dm.koneksi.Rollback;
    end;
    end;
    BBatalClick(sender);
end;

procedure TFInput_Supplier.FormShow(Sender: TObject);
begin
    TFListSupplier.Clear;
    Edno.SetFocus;
    BSimpan.Visible:=True;
    BEdit.Visible:=False;
end;

end.
