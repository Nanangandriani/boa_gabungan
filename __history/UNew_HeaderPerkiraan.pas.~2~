unit UNew_HeaderPerkiraan;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, RzButton, Vcl.ExtCtrls;

type
  TFNewHeaderPerkiraan = class(TForm)
    Label14: TLabel;
    Label15: TLabel;
    Label17: TLabel;
    Label16: TLabel;
    edkode_header: TEdit;
    ednama_header: TEdit;
    Panel2: TPanel;
    BBatal: TRzBitBtn;
    BSave: TRzBitBtn;
    procedure BBatalClick(Sender: TObject);
    procedure BSaveClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

Function FNewHeaderPerkiraan: TFNewHeaderPerkiraan;

implementation

{$R *.dfm}

uses UNewDaftar_perkiraan;
var
  realFNewHeaderPerkiraan : TFNewHeaderPerkiraan;
// implementasi function
function FNewHeaderPerkiraan: TFNewHeaderPerkiraan;
begin
  if realFNewHeaderPerkiraan <> nil then
    FNewHeaderPerkiraan:= RealFNewHeaderPerkiraan
  else
    Application.CreateForm(TFNewHeaderPerkiraan, Result);
end;

procedure TFNewHeaderPerkiraan.BBatalClick(Sender: TObject);
begin
  Close;
end;

procedure TFNewHeaderPerkiraan.BSaveClick(Sender: TObject);
begin
  if edkode_header.Text='' then
  begin
    MessageDlg('Kode Header Diisi..!!',mtInformation,[mbRetry],0);
  end
  else if ednama_header.Text='' then
  begin
    MessageDlg('Nama Header Wajib Diisi..!!',mtInformation,[mbRetry],0);
  end
  else
  begin
    with dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:='Insert Into t_header_perkiraan(kode_header,nama_header) '+
                'Values (:parkode_header,:parnama_header)';
      parambyname('parkode_header').Value:=edkode_header.Text;
      parambyname('parnama_header').Value:=ednama_header.Text;
      execsql;
    end;
    MessageDlg('Simpan Berhasil..!!',mtInformation,[MBOK],0);
  end;
  FNewdaftar_perkiraan_bank.CBheader.Clear;
  with dm.Qtemp do
  begin
    Close;
    Sql.Clear;
    Sql.Text:='select nama_header from t_header_perkiraan';
    Open;
  end;
  while not DM.Qtemp.Eof do
  begin
    FNewdaftar_perkiraan_bank.CBheader.Items.Add(DM.Qtemp.FieldByName('nama_header').AsString);
    DM.Qtemp.Next;
  end;
  Close;
end;

procedure TFNewHeaderPerkiraan.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  Action:=cafree;
end;

procedure TFNewHeaderPerkiraan.FormCreate(Sender: TObject);
begin
  realFNewHeaderPerkiraan:=self;
end;

procedure TFNewHeaderPerkiraan.FormDestroy(Sender: TObject);
begin
   realFNewHeaderPerkiraan:=nil;
end;

end.
