unit UListPelanggan;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, DBGridEhGrouping, ToolCtrlsEh,
  DBGridEhToolCtrls, DynVarsEh, dxSkinsCore, dxSkinBasic, dxSkinBlack,
  dxSkinBlue, dxSkinBlueprint, dxSkinCaramel, dxSkinCoffee, dxSkinDarkroom,
  dxSkinDarkSide, dxSkinDevExpressDarkStyle, dxSkinDevExpressStyle, dxSkinFoggy,
  dxSkinGlassOceans, dxSkinHighContrast, dxSkiniMaginary, dxSkinLilian,
  dxSkinLiquidSky, dxSkinLondonLiquidSky, dxSkinMcSkin, dxSkinMetropolis,
  dxSkinMetropolisDark, dxSkinMoneyTwins, dxSkinOffice2007Black,
  dxSkinOffice2007Blue, dxSkinOffice2007Green, dxSkinOffice2007Pink,
  dxSkinOffice2007Silver, dxSkinOffice2010Black, dxSkinOffice2010Blue,
  dxSkinOffice2010Silver, dxSkinOffice2013DarkGray, dxSkinOffice2013LightGray,
  dxSkinOffice2013White, dxSkinOffice2016Colorful, dxSkinOffice2016Dark,
  dxSkinOffice2019Black, dxSkinOffice2019Colorful, dxSkinOffice2019DarkGray,
  dxSkinOffice2019White, dxSkinPumpkin, dxSkinSeven, dxSkinSevenClassic,
  dxSkinSharp, dxSkinSharpPlus, dxSkinSilver, dxSkinSpringtime, dxSkinStardust,
  dxSkinSummer2008, dxSkinTheAsphaltWorld, dxSkinTheBezier,
  dxSkinsDefaultPainters, dxSkinValentine, dxSkinVisualStudio2013Blue,
  dxSkinVisualStudio2013Dark, dxSkinVisualStudio2013Light, dxSkinVS2010,
  dxSkinWhiteprint, dxSkinXmas2008Blue, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxCore, dxRibbonSkins, dxRibbonCustomizationForm,
  dxRibbon, dxBar, cxClasses, EhLibVCL, GridsEh, DBAxisGridsEh, DBGridEh,
  Data.DB, MemDS, DBAccess, Uni;

type
  TFListPelanggan = class(TForm)
    DBGridEh1: TDBGridEh;
    dxBarManager1: TdxBarManager;
    dxBarManager1Bar1: TdxBar;
    dxBarButton2: TdxBarButton;
    dxBarButton1: TdxBarButton;
    dxBarButton3: TdxBarButton;
    dxBarButton4: TdxBarButton;
    dxBarButton5: TdxBarButton;
    dxBarButton6: TdxBarButton;
    dxBarButton7: TdxBarButton;
    dxBarLargeButton1: TdxBarLargeButton;
    dxBarButton8: TdxBarButton;
    dxBarButton9: TdxBarButton;
    dxBarButton10: TdxBarButton;
    dxRibbon1: TdxRibbon;
    dxRibbon1Tab1: TdxRibbonTab;
    QPelanggan: TUniQuery;
    DsPelanggan: TDataSource;
    procedure dxBarLargeButton1Click(Sender: TObject);
    procedure dxBarButton8Click(Sender: TObject);
    procedure dxBarButton9Click(Sender: TObject);
    procedure dxBarButton10Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    procedure Refresh;

  end;

var
  FListPelanggan: TFListPelanggan;

implementation

{$R *.dfm}

uses UNew_Pelanggan, UDataModule;

procedure TFListPelanggan.Refresh;
begin
  DBGridEh1.StartLoadingStatus();
  try
    Qpelanggan.Close;
    Qpelanggan.Open;
  finally
  DBGridEh1.FinishLoadingStatus();
  end;
end;

procedure TFListPelanggan.dxBarButton10Click(Sender: TObject);
begin
  if MessageDlg('Apakah anda yakin ingin menghapus data ini?',mtConfirmation,[mbYes,mbNo],0)=mrYes then
  begin
    with Dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:='Delete From t_pelanggan where kode_pelanggan = '+QuotedStr(DBGridEh1.Fields[0].AsString);
      execsql;
    end;
    MessageDlg('Hapus Berhasil..!!',mtInformation,[MBOK],0);
    Refresh;
  end;
end;

procedure TFListPelanggan.dxBarButton8Click(Sender: TObject);
begin
  with QPelanggan do
  begin
    FNew_Pelanggan.Edkode.Text:=QPelanggan.FieldByName('kode_pelanggan').AsString;
    FNew_Pelanggan.Ednama.Text:=QPelanggan.FieldByName('nama_pelanggan').AsString;
    FNew_Pelanggan.MemAlamat.Text:=QPelanggan.FieldByName('alamat').AsString;
    FNew_Pelanggan.Edtelp.Text:=QPelanggan.FieldByName('telpon').AsString;
    FNew_Pelanggan.Edemail.Text:=QPelanggan.FieldByName('email').AsString;
    FNew_Pelanggan.Edtempo.Text:=QPelanggan.FieldByName('tempo_pembayaran').AsString;
  end;
  FNew_Pelanggan.Edkode.Enabled:=false;
  FNew_Pelanggan.Show;
  Status := 1;
end;

procedure TFListPelanggan.dxBarButton9Click(Sender: TObject);
begin
  self.Refresh;
end;

procedure TFListPelanggan.dxBarLargeButton1Click(Sender: TObject);
begin
  FNew_Pelanggan.ShowModal;
  FNew_Pelanggan.Clear;
  FNew_Pelanggan.Edkode.Enabled:=true;
  Status:=0;
end;

end.
