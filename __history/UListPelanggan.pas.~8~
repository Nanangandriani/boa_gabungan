unit UListPelanggan;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, DBGridEhGrouping, ToolCtrlsEh,
  DBGridEhToolCtrls, DynVarsEh, dxSkinsCore, dxSkinBasic, dxSkinBlack,
  dxSkinBlue, dxSkinBlueprint, dxSkinCaramel, dxSkinCoffee, dxSkinDarkroom,
  dxSkinDarkSide, dxSkinDevExpressDarkStyle, dxSkinDevExpressStyle, dxSkinFoggy,
  dxSkinGlassOceans, dxSkinHighContrast, dxSkiniMaginary, dxSkinLilian,
  dxSkinLiquidSky, dxSkinLondonLiquidSky, dxSkinMcSkin, dxSkinMetropolis,
  dxSkinMetropolisDark, dxSkinMoneyTwins, dxSkinOffice2007Black,
  dxSkinOffice2007Blue, dxSkinOffice2007Green, dxSkinOffice2007Pink,
  dxSkinOffice2007Silver, dxSkinOffice2010Black, dxSkinOffice2010Blue,
  dxSkinOffice2010Silver, dxSkinOffice2013DarkGray, dxSkinOffice2013LightGray,
  dxSkinOffice2013White, dxSkinOffice2016Colorful, dxSkinOffice2016Dark,
  dxSkinOffice2019Black, dxSkinOffice2019Colorful, dxSkinOffice2019DarkGray,
  dxSkinOffice2019White, dxSkinPumpkin, dxSkinSeven, dxSkinSevenClassic,
  dxSkinSharp, dxSkinSharpPlus, dxSkinSilver, dxSkinSpringtime, dxSkinStardust,
  dxSkinSummer2008, dxSkinTheAsphaltWorld, dxSkinTheBezier,
  dxSkinsDefaultPainters, dxSkinValentine, dxSkinVisualStudio2013Blue,
  dxSkinVisualStudio2013Dark, dxSkinVisualStudio2013Light, dxSkinVS2010,
  dxSkinWhiteprint, dxSkinXmas2008Blue, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxCore, dxRibbonSkins, dxRibbonCustomizationForm,
  dxRibbon, dxBar, cxClasses, EhLibVCL, GridsEh, DBAxisGridsEh, DBGridEh,
  Data.DB, MemDS, DBAccess, Uni, System.Actions, Vcl.ActnList,
  Vcl.PlatformDefaultStyleActnCtrls, Vcl.ActnMan;

type
  TFListPelanggan = class(TForm)
<<<<<<< HEAD
    DBGridCustomer: TDBGridEh;
=======
    DBGridEh1: TDBGridEh;
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
    dxBarManager1: TdxBarManager;
    dxBarManager1Bar1: TdxBar;
    dxBarButton2: TdxBarButton;
    dxBarButton1: TdxBarButton;
    dxBarButton3: TdxBarButton;
    dxBarButton4: TdxBarButton;
    dxBarButton5: TdxBarButton;
    dxBarButton6: TdxBarButton;
    dxBarButton7: TdxBarButton;
    dxBarLargeNew: TdxBarLargeButton;
    dxBarUpdate: TdxBarButton;
    dxBarRefresh: TdxBarButton;
    dxBarDelete: TdxBarButton;
    dxRibbon1: TdxRibbon;
    dxRibbon1Tab1: TdxRibbonTab;
    QPelanggan: TUniQuery;
    DsPelanggan: TDataSource;
    ActMenu: TActionManager;
    ActBaru: TAction;
    ActUpdate: TAction;
    ActRO: TAction;
    ActDel: TAction;
    ActPrint: TAction;
    ActApp: TAction;
    ActReject: TAction;
    ActClose: TAction;
<<<<<<< HEAD
    QPelanggancustomer_code: TStringField;
    QPelanggancustomer_name: TStringField;
    QPelanggantelp: TStringField;
    QPelangganemail: TStringField;
    QPelangganaddress: TMemoField;
    QPelanggannpwp: TStringField;
    QPelangganid: TGuidField;
    QPelanggancreated_at: TDateTimeField;
    QPelanggancreated_by: TStringField;
    QPelangganupdated_at: TDateTimeField;
    QPelangganupdated_by: TStringField;
    QPelanggandeleted_at: TDateTimeField;
    QPelanggandeleted_by: TStringField;
    QPelangganpayment_term: TSmallintField;
=======
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
    procedure dxBarLargeNewClick(Sender: TObject);
    procedure dxBarUpdateClick(Sender: TObject);
    procedure dxBarRefreshClick(Sender: TObject);
    procedure dxBarDeleteClick(Sender: TObject);
<<<<<<< HEAD
    procedure FormShow(Sender: TObject);
    procedure QPelangganaddressGetText(Sender: TField; var Text: string;
      DisplayText: Boolean);
=======
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
  private
    { Private declarations }
  public
    { Public declarations }
    procedure Refresh;

  end;

var
  FListPelanggan: TFListPelanggan;

implementation

{$R *.dfm}

uses UNew_Pelanggan, UDataModule;

procedure TFListPelanggan.Refresh;
begin
<<<<<<< HEAD
   with QPelanggan do
   begin
       close;
       sql.Clear;
       sql.Text:='select * from master_data.T_customer where deleted_at is null order by created_at Desc ';
       open;
   end;
   QPelanggan.Active:=False;
   QPelanggan.Active:=True;
   QPelanggan.Close;
   QPelanggan.Open;
end;

{procedure TFListPelanggan.Refresh;
begin
=======
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
  DBGridEh1.StartLoadingStatus();
  try
    Qpelanggan.Close;
    Qpelanggan.Open;
  finally
  DBGridEh1.FinishLoadingStatus();
  end;
<<<<<<< HEAD
end;}
=======
end;
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938

procedure TFListPelanggan.dxBarDeleteClick(Sender: TObject);
begin
  if MessageDlg('Apakah anda yakin ingin menghapus data ini?',mtConfirmation,[mbYes,mbNo],0)=mrYes then
  begin
    with Dm.Qtemp do
    begin
      close;
      sql.Clear;
<<<<<<< HEAD
      //sql.Text:='Delete From t_pelanggan where kode_pelanggan = '+QuotedStr(DBGridEh1.Fields[0].AsString);
      sql.Text:=' Update master_data.t_customer set deleted_at=:deleted_at,deleted_by=:deleted_by '+
                ' where customer_code='+QuotedStr(DBGridCustomer.Fields[0].AsString);
      parambyname('deleted_at').AsDateTime:=Now;
      parambyname('deleted_by').AsString:='Admin';
=======
      sql.Text:='Delete From t_pelanggan where kode_pelanggan = '+QuotedStr(DBGridEh1.Fields[0].AsString);
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
      execsql;
    end;
    MessageDlg('Hapus Berhasil..!!',mtInformation,[MBOK],0);
    Refresh;
  end;
end;

procedure TFListPelanggan.dxBarUpdateClick(Sender: TObject);
begin
  with QPelanggan do
  begin
    FNew_Pelanggan.Edkode.Text:=QPelanggan.FieldByName('customer_code').AsString;
    FNew_Pelanggan.Ednama.Text:=QPelanggan.FieldByName('customer_name').AsString;
    FNew_Pelanggan.MemAlamat.Text:=QPelanggan.FieldByName('address').AsString;
    FNew_Pelanggan.Edtelp.Text:=QPelanggan.FieldByName('telp').AsString;
    FNew_Pelanggan.Edemail.Text:=QPelanggan.FieldByName('email').AsString;
<<<<<<< HEAD
    FNew_Pelanggan.Edtempo.Text:=QPelanggan.FieldByName('payment_term').AsString;
=======
    FNew_Pelanggan.Edtempo.Text:=QPelanggan.FieldByName('payment term').AsString;
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
  end;
  FNew_Pelanggan.Edkode.Enabled:=false;
  FNew_Pelanggan.Show;
  Status := 1;
end;

<<<<<<< HEAD
procedure TFListPelanggan.FormShow(Sender: TObject);
begin
  Refresh;
end;

procedure TFListPelanggan.QPelangganaddressGetText(Sender: TField;
  var Text: string; DisplayText: Boolean);
begin
   Text := Copy(QPelangganaddress.AsString, 1, 200);
end;

procedure TFListPelanggan.dxBarRefreshClick(Sender: TObject);
begin
  DBGridcustomer.StartLoadingStatus();
  try
    Qpelanggan.Close;
    Qpelanggan.Open;
  finally
  DBGridcustomer.FinishLoadingStatus();
  end;
=======
procedure TFListPelanggan.dxBarRefreshClick(Sender: TObject);
begin
  self.Refresh;
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
end;

procedure TFListPelanggan.dxBarLargeNewClick(Sender: TObject);
begin
  FNew_Pelanggan.ShowModal;
  FNew_Pelanggan.Clear;
  FNew_Pelanggan.Edkode.Enabled:=true;
  Status:=0;
end;

end.
