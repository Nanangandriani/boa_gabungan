unit UListSupplier;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, DBGridEhGrouping, ToolCtrlsEh,
  DBGridEhToolCtrls, DynVarsEh, dxSkinsCore, dxSkinBasic, dxSkinBlack,
  dxSkinBlue, dxSkinBlueprint, dxSkinCaramel, dxSkinCoffee, dxSkinDarkroom,
  dxSkinDarkSide, dxSkinDevExpressDarkStyle, dxSkinDevExpressStyle, dxSkinFoggy,
  dxSkinGlassOceans, dxSkinHighContrast, dxSkiniMaginary, dxSkinLilian,
  dxSkinLiquidSky, dxSkinLondonLiquidSky, dxSkinMcSkin, dxSkinMetropolis,
  dxSkinMetropolisDark, dxSkinMoneyTwins, dxSkinOffice2007Black,
  dxSkinOffice2007Blue, dxSkinOffice2007Green, dxSkinOffice2007Pink,
  dxSkinOffice2007Silver, dxSkinOffice2010Black, dxSkinOffice2010Blue,
  dxSkinOffice2010Silver, dxSkinOffice2013DarkGray, dxSkinOffice2013LightGray,
  dxSkinOffice2013White, dxSkinOffice2016Colorful, dxSkinOffice2016Dark,
  dxSkinOffice2019Black, dxSkinOffice2019Colorful, dxSkinOffice2019DarkGray,
  dxSkinOffice2019White, dxSkinPumpkin, dxSkinSeven, dxSkinSevenClassic,
  dxSkinSharp, dxSkinSharpPlus, dxSkinSilver, dxSkinSpringtime, dxSkinStardust,
  dxSkinSummer2008, dxSkinTheAsphaltWorld, dxSkinTheBezier,
  dxSkinsDefaultPainters, dxSkinValentine, dxSkinVisualStudio2013Blue,
  dxSkinVisualStudio2013Dark, dxSkinVisualStudio2013Light, dxSkinVS2010,
  dxSkinWhiteprint, dxSkinXmas2008Blue, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxCore, dxRibbonSkins, dxRibbonCustomizationForm,
  dxRibbon, dxBar, cxClasses, EhLibVCL, GridsEh, DBAxisGridsEh, DBGridEh,
  Data.DB, MemDS, DBAccess, Uni;

type
  TFListSupplier = class(TForm)
    DBGridEh1: TDBGridEh;
    dxBarManager1: TdxBarManager;
    dxBarManager1Bar1: TdxBar;
    dxBarButton2: TdxBarButton;
    dxBarButton1: TdxBarButton;
    dxBarButton3: TdxBarButton;
    dxBarButton4: TdxBarButton;
    dxBarButton5: TdxBarButton;
    dxBarButton6: TdxBarButton;
    dxBarButton7: TdxBarButton;
    dxBarBaru: TdxBarLargeButton;
    dxBarUpdate: TdxBarButton;
    dxbarRefresh: TdxBarButton;
    dxBarDelete: TdxBarButton;
    dxRibbon1: TdxRibbon;
    dxRibbon1Tab1: TdxRibbonTab;
    DsSupplier: TDataSource;
    QSupplier: TUniQuery;
    procedure dxBarBaruClick(Sender: TObject);
    procedure dxBarUpdateClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    Procedure Clear;
    Procedure Refresh;
    Procedure Autonumber;
  end;

var
  FListSupplier: TFListSupplier;
  urut:integer;

implementation

{$R *.dfm}

uses UInput_Supplier, UDataModule;


procedure TFListSupplier.Clear;
begin
  FInput_Supplier.Edno.Text:='';
  FInput_Supplier.EdNm.Text:='';
  FInput_Supplier.EdAlamat.Text:='';
  FInput_Supplier.Edtelp.Text:='';
  FInput_Supplier.EdNPWP.Text:='';
end;

procedure TFListSupplier.Refresh;
begin

end;
procedure TFListSupplier.Autonumber;
begin
    with dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:=' SELECT max(t_supplier.no_supplier)AS urut FROM t_supplier';
      execsql;
    end;
    urut:=Dm.Qtemp.FieldByName('urut').AsInteger+1;
    FInput_Supplier.Edno.Text:=FloatToStr(urut);
end;

procedure TFListSupplier.dxBarUpdateClick(Sender: TObject);
begin
    FInput_Supplier.Show;
    FInput_Supplier.BSimpan.Visible:=False;
    FInput_Supplier.BEdit.Visible:=True;
    FInput_Supplier.Caption:='Update Supplier';
    FInput_Supplier.Edno.Enabled:=False;
    with QSupplier do
    begin
      FInput_Supplier.Edno.Text:=QSupplier.FieldByName('kd_supplier').AsString;
      FInput_Supplier.EdNm.Text:=QSupplier.FieldByName('nm_supplier').AsString;
      FInput_Supplier.Edalamat.Text:=QSupplier.FieldByName('alamat').AsString;
      FInput_Supplier.Edtelp.Text:=QSupplier.FieldByName('telp').AsString;
      FInput_Supplier.EdNPWP.Text:=QSupplier.FieldByName('npwp').AsString;
    end;
end;

procedure TFListSupplier.dxBarBaruClick(Sender: TObject);
begin
    self.clear;
    FInput_Supplier.Caption:='New Supplier';
    FInput_Supplier.showmodal;
end;

end.
