unit UNew_Gudang;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, RzButton, Vcl.ExtCtrls, Vcl.StdCtrls;

type
  TFNew_Gudang = class(TForm)
    CbCategory: TComboBox;
    CbSbu: TComboBox;
    Edkd: TEdit;
    Edkode: TEdit;
    Ednm: TEdit;
    Edno: TEdit;
    Label1: TLabel;
    Label10: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Panel1: TPanel;
    BBatal: TRzBitBtn;
    BSimpan: TRzBitBtn;
    BEdit: TRzBitBtn;
    procedure BBatalClick(Sender: TObject);
    procedure BEditClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    Procedure CLear;
  end;

var
  FNew_Gudang: TFNew_Gudang;

implementation

{$R *.dfm}

uses UDataModule;


procedure TFNew_Gudang.BEditClick(Sender: TObject);
begin
   if Ednm.Text='' then
begin
  MessageDlg('Nama Gudang Tidak boleh Kosong ',MtWarning,[MbOk],0);
  Ednm.SetFocus;
  Exit;
end;
with dm.Qtemp do
begin
  close;
  sql.Clear;
  sql.Text:='select * from t_gudang ';
  ExecSQL;
end;
with dm.Qtemp do
begin
  close;
  sql.Clear;
  sql.Text:='Update t_gudang set category='+QuotedStr(CbCategory.Text)+', nm_gudang='+QuotedStr(EdNm.Text)+',kd_gudang='+QuotedStr(Edkd.Text)+',kd_sbu='+QuotedStr(CbSbu.Text)+' where kode='+QuotedStr(Edkode.Text)+' and no_urut='+QuotedStr(Edno.Text);
  ExecSQL;
end;
BBatalClick(sender);
end;

procedure TFNew_gudang.BSimpanClick(Sender: TObject);
begin
    if Ednm.Text='' then
    begin
      MessageDlg('Nama Gudang Tidak boleh Kosong ',MtWarning,[MbOk],0);
      Ednm.SetFocus;
      Exit;
    end;
    with dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:='select * from t_gudang ';
      ExecSQL;
    end;
    with dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:='insert into t_gudang(nm_gudang,kd_gudang,kd_sbu,category,kode) '+
                ' values('+QuotedStr(EdNm.Text)+','+QuotedStr(Edkd.Text)+','+QuotedStr(CbSbu.Text)+','+QuotedStr(CbCategory.Text)+','+QuotedStr(Edkode.Text)+')';
      ExecSQL;
    end;
    BBatalClick(sender);
end;

procedure TFNew_Gudang.CLear;
begin
   Edkd.Clear;
   Ednm.Clear;
   CbSbu.Clear;
   CbCategory.Clear;
end;

procedure TFNew_Gudang.BBatalClick(Sender: TObject);
begin
  Close;
end;

end.
