unit UListSupplier;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, DBGridEhGrouping, ToolCtrlsEh,
  DBGridEhToolCtrls, DynVarsEh, dxSkinsCore, dxSkinBasic, dxSkinBlack,
  dxSkinBlue, dxSkinBlueprint, dxSkinCaramel, dxSkinCoffee, dxSkinDarkroom,
  dxSkinDarkSide, dxSkinDevExpressDarkStyle, dxSkinDevExpressStyle, dxSkinFoggy,
  dxSkinGlassOceans, dxSkinHighContrast, dxSkiniMaginary, dxSkinLilian,
  dxSkinLiquidSky, dxSkinLondonLiquidSky, dxSkinMcSkin, dxSkinMetropolis,
  dxSkinMetropolisDark, dxSkinMoneyTwins, dxSkinOffice2007Black,
  dxSkinOffice2007Blue, dxSkinOffice2007Green, dxSkinOffice2007Pink,
  dxSkinOffice2007Silver, dxSkinOffice2010Black, dxSkinOffice2010Blue,
  dxSkinOffice2010Silver, dxSkinOffice2013DarkGray, dxSkinOffice2013LightGray,
  dxSkinOffice2013White, dxSkinOffice2016Colorful, dxSkinOffice2016Dark,
  dxSkinOffice2019Black, dxSkinOffice2019Colorful, dxSkinOffice2019DarkGray,
  dxSkinOffice2019White, dxSkinPumpkin, dxSkinSeven, dxSkinSevenClassic,
  dxSkinSharp, dxSkinSharpPlus, dxSkinSilver, dxSkinSpringtime, dxSkinStardust,
  dxSkinSummer2008, dxSkinTheAsphaltWorld, dxSkinTheBezier,
  dxSkinsDefaultPainters, dxSkinValentine, dxSkinVisualStudio2013Blue,
  dxSkinVisualStudio2013Dark, dxSkinVisualStudio2013Light, dxSkinVS2010,
  dxSkinWhiteprint, dxSkinXmas2008Blue, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxCore, dxRibbonSkins, dxRibbonCustomizationForm,
  dxRibbon, dxBar, cxClasses, EhLibVCL, GridsEh, DBAxisGridsEh, DBGridEh,
  Data.DB, MemDS, DBAccess, Uni;

type
  TFListSupplier = class(TForm)
    DBGridSupplier: TDBGridEh;
    dxBarManager1: TdxBarManager;
    dxBarManager1Bar1: TdxBar;
    dxBarButton2: TdxBarButton;
    dxBarButton1: TdxBarButton;
    dxBarButton3: TdxBarButton;
    dxBarButton4: TdxBarButton;
    dxBarButton5: TdxBarButton;
    dxBarButton6: TdxBarButton;
    dxBarButton7: TdxBarButton;
    dxBarBaru: TdxBarLargeButton;
    dxBarUpdate: TdxBarButton;
    dxbarRefresh: TdxBarButton;
    dxBarDelete: TdxBarButton;
    dxRibbon1: TdxRibbon;
    dxRibbon1Tab1: TdxRibbonTab;
    DsSupplier: TDataSource;
    QSupplier: TUniQuery;
    procedure dxBarBaruClick(Sender: TObject);
    procedure dxBarUpdateClick(Sender: TObject);
    procedure dxbarRefreshClick(Sender: TObject);
    procedure dxBarDeleteClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }

    Procedure Refresh;
    Procedure Autonumber;
  end;

var
  FListSupplier: TFListSupplier;
  urut:integer;

implementation

{$R *.dfm}

<<<<<<< HEAD
uses UNew_Supplier, UDataModule;
=======
uses UNew_Supplier, UDataModule, UInput_Supplier;


>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938


procedure TFListSupplier.Refresh;
begin
   QSupplier.Active:=False;
   QSupplier.Active:=True;
end;
<<<<<<< HEAD

=======
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
procedure TFListSupplier.Autonumber;
begin
    with dm.Qtemp do
    begin
      close;
      sql.Clear;
      sql.Text:=' SELECT max(t_supplier.no_supplier)AS urut FROM t_supplier';
      execsql;
    end;
    urut:=Dm.Qtemp.FieldByName('urut').AsInteger+1;
<<<<<<< HEAD
    FInput_Supplier.Edno.Text:=FloatToStr(urut);
=======
    FNew_Supplier.Edno.Text:=FloatToStr(urut);
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
end;

procedure TFListSupplier.dxBarUpdateClick(Sender: TObject);
begin
<<<<<<< HEAD
    FInput_Supplier.Show;
    FInput_Supplier.BSimpan.Visible:=False;
    FInput_Supplier.BEdit.Visible:=True;
    FInput_Supplier.Caption:='Update Supplier';
    FInput_Supplier.Edno.Enabled:=False;
=======
    FNew_Supplier.Show;
    FNew_Supplier.BSimpan.Visible:=False;
    FNew_Supplier.BEdit.Visible:=True;
    FNew_Supplier.Caption:='Update Supplier';
    FNew_Supplier.Edno.Enabled:=False;
>>>>>>> 8f4a1c83bd26b538d93f7e8791f7a4a22a612938
    with QSupplier do
    begin
      FInput_Supplier.Edno.Text:=QSupplier.FieldByName('kd_supplier').AsString;
      FInput_Supplier.EdNm.Text:=QSupplier.FieldByName('nm_supplier').AsString;
      FInput_Supplier.Edalamat.Text:=QSupplier.FieldByName('alamat').AsString;
      FInput_Supplier.Edtelp.Text:=QSupplier.FieldByName('telp').AsString;
      FInput_Supplier.EdNPWP.Text:=QSupplier.FieldByName('npwp').AsString;
    end;
end;

procedure TFListSupplier.dxBarBaruClick(Sender: TObject);
begin
    FInput_Supplier.Caption:='New Supplier';
    FInput_Supplier.showmodal;
end;

procedure TFListSupplier.dxBarDeleteClick(Sender: TObject);
begin
    if messageDlg ('Anda Yakin Akan Menghapus Data '+DBGridSupplier.Fields[1].AsString+' '+ '?', mtInformation,  [mbYes]+[mbNo],0) = mrYes then
    begin
      with dm.Qtemp do
      begin
        Close;
        sql.Clear;
        sql.Text:='Delete From t_supplier where kd_supplier='+QuotedStr(DBGridSupplier.Fields[0].AsString);
        Execute;
      end;
      dxbarRefreshClick(sender);
      ShowMessage('Data Berhasil di Hapus');
    end;
end;

procedure TFListSupplier.dxbarRefreshClick(Sender: TObject);
begin
   DBGridSupplier.StartLoadingStatus();
   DBGridSupplier.FinishLoadingStatus();
   Refresh;
end;

end.
